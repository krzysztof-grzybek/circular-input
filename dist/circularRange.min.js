!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():window.circularRange=t()}(function(){"use strict";function t(t){var e=Object.prototype.toString.call(t);return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e)&&"number"==typeof t.length&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)}function e(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes}function i(t){var e,i;for(e=document.createElementNS("http://www.w3.org/1999/xhtml","div"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t+"</svg>",i=document.createDocumentFragment();e.firstChild.firstChild;)i.appendChild(e.firstChild.firstChild);return i}function n(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function s(t,e,i,n){var s=n*Math.PI/180;return{x:t+i*Math.cos(s),y:e+i*Math.sin(s)}}function r(t,e,i,n,r){var a=s(t,e,i,r),o=s(t,e,i,n),c=180>=r-n?"0":"1",u=["M",a.x,a.y,"A",i,i,0,c,0,o.x,o.y].join(" ");return u}function a(e,i){if(!(this instanceof a))return new a(e,i);if(t(e)){for(var s=[],r=0;r<e.length;r++)s.push(new a(e[r]));return s}return"undefined"!=typeof e[c]?u[e[c]]:(e[c]=o,u[o]=this,o++,this.input=e,this.svgEl=null,this.indicator=null,this.activeArc=null,this.options=n({},a.DEFAULTS),this.options=n(this.options,this.getDomOptions()),this.options=n(this.options,i),this.value=this.input.value?Number(this.input.value):this.options.min,this.pxPerStep=this.options.sensivity/((this.options.max-this.options.min)/this.options.step),this.init(),this)}var o=0,c="circularRange"+(new Date).getTime(),u=[],h=function(){return document.createEvent?function(t,e){var i=new Event(e);t.dispatchEvent(i)}:function(t,e){var i=document.createEventObject();t.fireEvent("on"+e,i)}}();return a.DEFAULTS={min:0,max:100,step:5,sensivity:100,theme:"",svgDefs:""},a.CLASS_NAMES={meter:"circ-range__meter",circle:"circ-range__circle",basicArc:"circ-range__basic-arc",activeArc:"circ-range__active-arc",indicator:"circ-range__indicator"},a.DISPLAY={arcAngle:300,arcRadius:14,boxSize:36},a.domStrings={container:'<div class="circ-range"></div>',svg:['<svg class="circ-range__svg" ','viewBox="0 0 ',a.DISPLAY.boxSize," ",a.DISPLAY.boxSize,'" ','version="1.1" xmlns="http://www.w3.org/2000/svg">',"<defs></defs>",'<path class="',a.CLASS_NAMES.meter,'"></path>',"<circle ",'cx="',a.DISPLAY.boxSize/2,'" ','cy="',a.DISPLAY.boxSize/2,'" r="14" ','class="',a.CLASS_NAMES.circle,'"></circle>','<path class="',a.CLASS_NAMES.basicArc,'"></path>','<path class="',a.CLASS_NAMES.activeArc,'"></path>','<line class="',a.CLASS_NAMES.indicator,'" x1="0" y1="0" x2="0" y2="',a.DISPLAY.arcRadius,'"></line>',"</svg>"].join("")},a.prototype={getDomOptions:function(){for(var t={},e=Object.keys(a.DEFAULTS),i=0;i<e.length;i++){var n=e[i],s=this.input.getAttribute("data-"+n);null!==s&&(t[n]=Number(s))}return t},init:function(){this.createDOM(),this.addEventHandlers(),this.updateView()},createDOM:function(){var t,n,s,r,o=e(a.domStrings.container)[0];this.input.parentNode.insertBefore(o,this.input),o.innerHTML=a.domStrings.svg,o.appendChild(this.input),this.svgEl=o.firstChild,this.indicator=o.getElementsByClassName(a.CLASS_NAMES.indicator)[0],this.activeArc=o.getElementsByClassName(a.CLASS_NAMES.activeArc)[0],r=o.getElementsByTagName("defs")[0],t=o.getElementsByClassName(a.CLASS_NAMES.circle)[0],t.setAttribute("d",this.describeArc(359)),n=o.getElementsByClassName(a.CLASS_NAMES.basicArc)[0],n.setAttribute("d",this.describeArc(a.DISPLAY.arcAngle)),s=o.getElementsByClassName(a.CLASS_NAMES.meter)[0],s.setAttribute("d",this.describeArc(a.DISPLAY.arcAngle,a.DISPLAY.arcRadius+2)),this.options.theme&&(o.className+=" circ-range--"+this.options.theme),r.appendChild(i(this.options.svgDefs))},addEventHandlers:function(){var t=this;this.svgEl.addEventListener("mousedown",function(e){e.preventDefault();var i=e.pageY,n=t.value,s=function(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)},r=function(e){t.mouseMoveValueChange(e,n,i)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)}),this.input.addEventListener("blur",function(){t.keyboardInputValueChange()}),this.svgEl.addEventListener("touchmove",function(t){t.preventDefault()})},mouseMoveValueChange:function(t,e,i){var n,s,r;t.preventDefault(),n=-(t.pageY-i),s=Math.round(n/this.pxPerStep)*this.options.step,r=e+s,this.value=r,this.validateValue(),this.updateView()},keyboardInputValueChange:function(){this.value=parseFloat(this.input.value),this.validateValue(),this.updateView()},updateView:function(){this.updateCricleView(),this.updateInputView()},updateCricleView:function(){var t,e,i,n;t=this.value/(this.options.max-this.options.min),e=t*a.DISPLAY.arcAngle,i=this.getIndicatorRotation(e),n=this.getIndicatorTranslation(),this.indicator.setAttribute("transform",n+" "+i),this.activeArc.setAttribute("d",this.describeArc(e))},updateInputView:function(){this.input.value=this.value,h(this.input,"change")},getIndicatorRotation:function(t){var e=(360-a.DISPLAY.arcAngle)/2;return"rotate("+(t+e)+" 0 0)"},getIndicatorTranslation:function(){var t=a.DISPLAY.boxSize/2;return"translate("+t+" "+t+")"},describeArc:function(t,e){var i=90+(360-a.DISPLAY.arcAngle)/2,n=a.DISPLAY.boxSize/2,s=a.DISPLAY.boxSize/2,e="undefined"!=typeof e?e:a.DISPLAY.arcRadius;return r(n,s,e,i,t+i)},validateValue:function(){this.value=this.options.min+Math.round((this.value-this.options.min)/this.options.step)*this.options.step,this.value=this.value<=this.options.max?this.value:this.options.max,this.value=this.value>=this.options.min?this.value:this.options.min}},a});