!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():window.circularInput=t()}(function(){"use strict";function t(t){var e=Object.prototype.toString.call(t);return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e)&&"number"==typeof t.length&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)}function e(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes}function i(t){var e,i;for(e=document.createElementNS("http://www.w3.org/1999/xhtml","div"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t+"</svg>",i=document.createDocumentFragment();e.firstChild.firstChild;)i.appendChild(e.firstChild.firstChild);return i}function n(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function s(t,e,i,n){var s=n*Math.PI/180;return{x:t+i*Math.cos(s),y:e+i*Math.sin(s)}}function r(t,e,i,n,r){var o=s(t,e,i,r),a=s(t,e,i,n),c=r-n<=180?"0":"1",u=["M",o.x,o.y,"A",i,i,0,c,0,a.x,a.y].join(" ");return u}function o(t){var e=t.toString().split(".");return 1===e.length?0:e.length>1?e.pop().length:void 0}function a(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)}function c(e,i){if(!(this instanceof c))return new c(e,i);if(t(e)){for(var s=[],r=0;r<e.length;r++)s.push(new c(e[r],i));return s}return"undefined"!=typeof e[h]?d[e[h]]:(e[h]=u,d[u]=this,u++,this.input=e,this.svgEl=null,this.indicator=null,this.activeArc=null,this.options=n({},c.DEFAULTS),this.options=n(this.options,this.getDomOptions()),this.options=n(this.options,i),this.value=this.input.value?Number(this.input.value):this.options.min,this.pxPerStep=this.options.sensivity/((this.options.max-this.options.min)/this.options.step),this.decimalPartLength=o(this.options.step),this.init(),this)}var u=0,h="circularInput"+(new Date).getTime(),d=[],p=function(){return document.createEvent?function(t,e){var i=document.createEvent("Event");i.initEvent(e,!0,!0),t.dispatchEvent(i)}:function(t,e){var i=document.createEventObject();t.fireEvent("on"+e,i)}}();return c.DEFAULTS={min:0,max:100,step:5,sensivity:100,theme:"",svgDefs:""},c.CLASS_NAMES={meter:"circ-input__meter",circle:"circ-input__circle",basicArc:"circ-input__basic-arc",activeArc:"circ-input__active-arc",indicator:"circ-input__indicator"},c.DISPLAY={arcAngle:300,arcRadius:14,boxSize:36},c.domStrings={container:'<div class="circ-input"></div>',svg:['<svg class="circ-input__svg" ','viewBox="0 0 ',c.DISPLAY.boxSize," ",c.DISPLAY.boxSize,'" ','version="1.1" xmlns="http://www.w3.org/2000/svg">',"<defs></defs>",'<path class="',c.CLASS_NAMES.meter,'"></path>',"<circle ",'cx="',c.DISPLAY.boxSize/2,'" ','cy="',c.DISPLAY.boxSize/2,'" r="14" ','class="',c.CLASS_NAMES.circle,'"></circle>','<path class="',c.CLASS_NAMES.basicArc,'"></path>','<path class="',c.CLASS_NAMES.activeArc,'"></path>','<line class="',c.CLASS_NAMES.indicator,'" x1="0" y1="0" x2="0" y2="',c.DISPLAY.arcRadius,'"></line>',"</svg>"].join("")},c.prototype={getDomOptions:function(){for(var t={},e=Object.keys(c.DEFAULTS),i=0;i<e.length;i++){var n=e[i],s=this.input.getAttribute("data-"+n);null!==s&&(t[n]=Number(s))}return t},init:function(){this.createDOM(),this.addEventHandlers(),this.updateView()},createDOM:function(){var t,n,s,r,o=e(c.domStrings.container)[0];this.input.parentNode.insertBefore(o,this.input),o.innerHTML=c.domStrings.svg,o.appendChild(this.input),this.svgEl=o.firstChild,this.indicator=o.getElementsByClassName(c.CLASS_NAMES.indicator)[0],this.activeArc=o.getElementsByClassName(c.CLASS_NAMES.activeArc)[0],r=o.getElementsByTagName("defs")[0],t=o.getElementsByClassName(c.CLASS_NAMES.circle)[0],t.setAttribute("d",this.describeArc(359)),n=o.getElementsByClassName(c.CLASS_NAMES.basicArc)[0],n.setAttribute("d",this.describeArc(c.DISPLAY.arcAngle)),s=o.getElementsByClassName(c.CLASS_NAMES.meter)[0],s.setAttribute("d",this.describeArc(c.DISPLAY.arcAngle,c.DISPLAY.arcRadius+2)),this.options.theme&&(o.className+=" circ-input--"+this.options.theme),r.appendChild(i(this.options.svgDefs))},addEventHandlers:function(){var t=this;this.svgEl.addEventListener("mousedown",function(e){e.preventDefault();var i=e.pageY,n=t.value,s=function(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)},r=function(e){t.mouseMoveValueChange(e,n,i)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)}),this.input.addEventListener("blur",function(){t.keyboardInputValueChange()}),this.svgEl.addEventListener("touchmove",function(t){t.preventDefault()})},mouseMoveValueChange:function(t,e,i){var n,s,r;t.preventDefault(),n=-(t.pageY-i),s=Math.round(n/this.pxPerStep)*this.options.step,r=e+s,this.setValue(r)},keyboardInputValueChange:function(){var t=parseFloat(this.input.value);this.setValue(t)},updateView:function(){this.updateCricleView(),this.updateInputView()},updateCricleView:function(){var t,e,i,n;t=this.value/(this.options.max-this.options.min),e=t*c.DISPLAY.arcAngle,i=this.getIndicatorRotation(e),n=this.getIndicatorTranslation(),this.indicator.setAttribute("transform",n+" "+i),this.activeArc.setAttribute("d",this.describeArc(e))},setValue:function(t){this.value=this.validateValue(t),this.updateView()},updateInputView:function(){this.input.value=this.value.toFixed(this.decimalPartLength),p(this.input,"change")},getIndicatorRotation:function(t){var e=(360-c.DISPLAY.arcAngle)/2;return"rotate("+(t+e)+" 0 0)"},getIndicatorTranslation:function(){var t=c.DISPLAY.boxSize/2;return"translate("+t+" "+t+")"},describeArc:function(t,e){var i=90+(360-c.DISPLAY.arcAngle)/2,n=c.DISPLAY.boxSize/2,s=c.DISPLAY.boxSize/2,e="undefined"!=typeof e?e:c.DISPLAY.arcRadius;return r(n,s,e,i,t+i)},validateValue:function(t){return t=this.options.min+Math.round((t-this.options.min)/this.options.step)*this.options.step,t=t<=this.options.max?t:this.options.max,t=t>=this.options.min?t:this.options.min,a(t,this.decimalPartLength)}},c});